
Generate Sample
```{r}
my_data = read.csv('STA304 Group Project Dataset.csv', header = TRUE, sep=',')
# my_data

# Remove the column 'X'
data_cleaned <- my_data[, !(names(my_data) == "X")]
# Remove fake responses: rows 3 and 12
data_cleaned <- data_cleaned[-c(3, 12),]
# data_cleaned

# Calculating sample size
N = 200
B = .29
D = (B^2)/4
# sigma = sd(data_cleaned$academic_workload)
sigma2 = (max(data_cleaned$academic_workload) - min(data_cleaned$academic_workload))/4
# n = ceiling((N*sigma^2) / ((N-1)*D + sigma^2))
n = ceiling((N*sigma2) / ((N-1)*D + sigma2))
# sigma2
n

# Select a random sample of n rows
set.seed(1)
random_indices <- sample(1:nrow(data_cleaned), n)
sample_data <- data_cleaned[random_indices, ]
# sample_data
attach(sample_data)
```

# 4. Analysis

Section 1. Chi-square Test for Independence

Section 2. Simple and Multiple Linear Regressions

This part of the analysis is concerned with the application of linear regression to answer the three research questions as outlined above in the introduction.

## Research Question 1

### a. Relevant graphs & tables
Research Question 1 is concerned with determining whether there is a relationship between studentsâ€™ academic workload and the prevalence of mental health issues in students. To answer this question, we start by plotting a boxplot of academic workload by stress level. This plot suggests that higher stress levels are associated with a higher academic workload. On average, students who "Always" or "Sometimes" feel stressed tend to have a higher workload than those who "Never" feel stressed. 

```{r}
library(ggplot2)

sample_data$stress <- factor(sample_data$stress, levels = c("Never", "Sometimes", "Always"))
boxplot_plot <- ggplot(sample_data, aes(x = factor(stress), y = academic_workload)) +
  geom_boxplot(fill = "#56B4E9", color = "black") +
  labs(title = "Boxplot of Academic Workload by Stress Level",
       x = "Stress Level",
       y = "Academic Workload") +
  theme_minimal()
print(boxplot_plot)

# # Create a boxplot of hours_sleep by stress_binary
# boxplot_plot <- ggplot(sample_data, aes(x = factor(stress_binary), y = hours_sleep)) +
#   geom_boxplot(fill = "#56B4E9", color = "black") +  # Customize the colors if desired
#   labs(title = "Boxplot of Hours of Sleep by Stress Level",
#        x = "Stress (0 = No Stress, 1 = Stress)",
#        y = "Hours of Sleep") +
#   theme_minimal()

# # Display the plot
# print(boxplot_plot)
```
### c. Necessary Assumptions

To confirm this hypothesis, we implement a simple linear regression model, where the dependent variable is stress_numeric (the stress variable, converted to numeric values), and the independent variable is academic_workload. To implement this model, we check the following assumptions using the following plot of the residuals:

![Residuals Plot](residuals_rq1.png){width=80%}

 1. Independence of errors: Since the plot has no noticable pattern, the independence assumption is satisfied.
 2. Normality of errors: Since our sample size is sufficiently large, by the Central Limit Theorem the sample mean (and by extension, the sampling distribution of residuals) approximately follows a Normal distribution. 
 3. Homogeneity of variances amongst errors: Since the residuals plot has a "horizontal band appearance", this suggests that the error have mean zero and a constant variance.

 Since all the assumptions are met, we run the regression and obtain the output below using the code in Appendix B:

### d. Computation and statistical test output

Call:
lm(formula = stress_numeric ~ academic_workload, data = sample_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.5301 -0.3668  0.1434  0.4699  0.7965

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)   
(Intercept)        1.22389    0.40942   2.989  0.00495 **
academic_workload  0.32655    0.09945   3.284  0.00224 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5353 on 37 degrees of freedom
Multiple R-squared:  0.2256,    Adjusted R-squared:  0.2047
F-statistic: 10.78 on 1 and 37 DF,  p-value: 0.002245

The equation of the regression line is given by: $stress = 1.22389 + 0.32655*workload$

### e. Interpretation

The small $p-value = 0.00224$ indicates that academic workload is a significant predictor of stress. Therefore, we can conclude that there is a significant relationship between students academic workload and their stress levels.

# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # 

## Research Question 2

### a. Relevant graphs & tables
```{r}
boxplot_plot <- ggplot(sample_data, aes(x = factor(missed_social_events), y = hours_sleep)) +
  geom_boxplot(fill = "#56B4E9", color = "black") +  # Customize the colors if desired
  labs(title = "Boxplot of Hours of Sleep by Missed Social Events",
       x = "Missed Social Events",
       y = "Hours of Sleep") +
  theme_minimal()

# Display the plot
print(boxplot_plot)

```

### b. Sample size Computations
### c. Necessary Assumptions

### d. Computation and statistical test output
```{r}
rq2.lm = lm(hours_sleep ~ academic_workload + missed_social_events, data = sample_data)
summary(rq2.lm)
```

### e. Extra statistical information
```{r}
cor(hours_sleep, academic_workload)
```


# # # # # # # # # # # # # # # # # # # # # # 

## Research Question 3

### a. Relevant graphs & tables

```{r}
boxplot_plot <- ggplot(sample_data, aes(x = factor(stress), y = missed_social_events)) +
  geom_boxplot(fill = "#56B4E9", color = "black") +
  labs(title = "Boxplot of Missed Social Events by Stress Level",
       x = "Missed Social Events",
       y = "Stress Level") +
  theme_minimal()
print(boxplot_plot)
```

### b. Sample size Computations
### c. Necessary Assumptions

### d. Computation and statistical test output
```{r}
rq3.lm <- lm(stress_numeric ~ missed_social_events + living_situation, data = sample_data)
summary(rq3.lm)
```
### e. Extra statistical information



Section 3. ANOVA






# Appendix B

```{r}
# Research Question 1 - Simple Linear Regression
sample_data$stress_numeric <- as.numeric(factor(sample_data$stress, levels = c("Never", "Sometimes", "Always")))
rq1_stress.lm = lm(stress_numeric ~ academic_workload, data = sample_data)
summary(rq1_stress.lm)
```

```{r}
# Assumptions for Research Question 1 - Simple Linear Regression
png("residuals_rq1.png", width = 800, height = 600)
# Plot code goes here, for example:
plot(rq1_stress.lm)
dev.off()
```







# # # # # # # # # # # # #

Anova:
variation in academic workload is significantly related to variation in stress.
variations in hours of sleep do not significantly relate to variations in stress levels.
stress levels** and **missed social events** do not have a significant relationship.




Old stuff
```{r}


# Recode stress as binary (0 = Not Stressed, 1 = Stressed)
# sample_data$stress_binary <- ifelse(sample_data$stress == "Never", 0, 1)
# sample_data$anxiety_binary <- ifelse(sample_data$anxiety == "Never", 0, 1)
# sample_data$concentration_binary <- ifelse(sample_data$concentration == "Never", 0, 1)

# sleep1_3.lm = lm(hours_sleep ~ stress_binary + missed_social_events, data = sample_data)
# summary(sleep1_3.lm) # 0.402, 0.008, F: 0.003886

# sleep1_1.lm = lm(hours_sleep ~ time_management + stress_binary + missed_social_events, data = sample_data)
# summary(sleep1_1.lm) # 0.42770, 0.60898, 0.00703, F: 0.008939

# time1.lm = lm(time_management ~ stress - studentID, data = sample_data)
# summary(time1.lm) # 0.0160, 0.0616, F: 0.02051

# mental_health.lm <- lm(stress_binary ~ academic_workload, data = sample_data) # 0.00201, 0.00925, F: 0.009247
# summary(mental_health.lm)

# library(nnet)
# # Multinomial logistic regression (Classification)
# stress_model_multi <- multinom(stress ~ hours_sleep + academic_workload, data = sample_data)
# summary(stress_model_multi)
# # Calculate z-scores and p-values for each coefficient
# z_scores <- summary(stress_model_multi)$coefficients / summary(stress_model_multi)$standard.errors
# p_values <- 2 * (1 - pnorm(abs(z_scores)))  # Two-tailed p-values
# z_scores
# p_values

# p_values <- p_values * 0.01
```




SIMPLE TEST 1: CHI-SQUARE TEST FOR INDEPENDENCE
```{r}
# X-squared = 4.2481, df = 1, p-value = 0.03929
# After grouping categories
# Group categories for anxiety and concentration
sample_data$anxiety_grouped <- ifelse(anxiety == "Always", "Always", "Other")
sample_data$concentration_grouped <- ifelse(concentration == "Always", "Always", "Other")

# Create a contingency table
contingency_table <- table(sample_data$anxiety_grouped, sample_data$concentration_grouped)

# Print the contingency table
cat("Contingency Table:\n")
print(contingency_table)

# Check expected Frequencies
chi_sq_test <- chisq.test(contingency_table)
chi_sq_test$expected

# Perform the Chi-squared test
chi_squared_test <- chisq.test(contingency_table)

# Print the results
cat("\nChi-squared Test Results:\n")
print(chi_squared_test)
```